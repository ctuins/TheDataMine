list.files("/anvil/projects/tdm/data/craigslist")
myDF <- read.csv("/anvil/projects/tdm/data/craigslist/vehicles.csv", stringsAsFactors = TRUE)

options(repr.matrix.max.cols=25, repr.matrix.max.rows=200)
head(myDF$region, n = 50)

length(myDF$year[myDF$year >= 2011])
max(myDF$year, na.rm=T)
min(myDF$year, na.rm=T)
head(sort(table(myDF$year), decreasing=TRUE))

myDF$newflag <- NA
myDF$newflag[myDF$condition == "like new"] <- TRUE
myDF$newflag[myDF$condition != "like new"] <- FALSE
table(myDF$newflag)

myDF$pricecategory <- NA
myDF$pricecategory[myDF$price <= 1500] <- 'cheap'
myDF$pricecategory[myDF$price >1500 & myDF$price <= 10000] <- 'average'
myDF$pricecategory[myDF$price >10000] <- 'expensive'
table(myDF$pricecategory, useNA = 'always')

table(myDF$newflag)
myDF$newpricecategory <- cut(myDF$price, breaks = c(-Inf, 1500,10000, Inf), labels = c('cheap', 'average', 'expensive'))
head(myDF$newpricecategory)
table(myDF$newpricecategory)

myDF$odometerage <- cut(myDF$odometer, breaks = c(-Inf, 50000, 100000, Inf), labels = c('new', 'middle age', 'old'))
table(myDF$odometerage, useNA = 'always')

myIndy <- subset(myDF, (region == "indianapolis"&(!is.na(long))&(!is.na(lat))))
head(sort(table(myDF$region), decreasing = T))
popularRegion <- subset(myDF, region == "springfield")
myChoice <- subset(myDF, region == "richmond")

library(leaflet)
library(sf)
points <- st_as_sf(myIndy, coords=c("long", "lat"), crs=4326)
addCircleMarkers(addTiles(leaflet(myIndy)), radius = 1)
addCircleMarkers(addTiles(leaflet(popularRegion)), radius = 1)
addCircleMarkers(addTiles(leaflet(myChoice)), radius = 1)